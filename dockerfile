FROM fedora:40@sha256:5ce8497aeea599bf6b54ab3979133923d82aaa4f6ca5ced1812611b197c79eb0
  #Maintaner of Dockerfile
MAINTAINER David Gonzalez Pozo <davidgpozo@gmail.com>
# Install openssh server
RUN dnf -y install openssh-server 
RUN mkdir -p /var/run/sshd

# Ensure env
RUN echo 'root:root123' | chpasswd
RUN sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config
RUN sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
RUN ssh-keygen -A

# Copy vulnerable library with own key
COPY liblzma.so.5.6.0.patch /root/
EXPOSE 22
ENV LD_PRELOAD=/root/liblzma.so.5.6.0.patch

ENV SHELL=/bin/bash
CMD ["/usr/sbin/sshd", "-D"]
